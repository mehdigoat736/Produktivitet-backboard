<!DOCTYPE html>
<html lang="no">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>mehdi.co // Aura</title>
    
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* --- AURA PALETTE --- */
            --bg-color: #e0f7fa; /* Light cyan background */
            --primary-gradient: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%); /* Blue-Cyan Gradient */
            --glass-surface: rgba(255, 255, 255, 0.75);
            --glass-border: rgba(255, 255, 255, 0.8);
            --text-main: #1e293b;
            --text-muted: #64748b;
            --success: #10b981;
            --danger: #ef4444;
            --shadow-soft: 0 10px 30px rgba(0, 114, 255, 0.15);
            --radius-lg: 30px;
            --radius-md: 20px;
        }

        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; outline: none; user-select: none; }
        
        body {
            margin: 0; font-family: 'Poppins', sans-serif;
            background-color: var(--bg-color); color: var(--text-main);
            height: 100vh; overflow: hidden;
            /* Subtle animated background mesh */
            background-image: 
                radial-gradient(at 0% 0%, hsla(192,100%,70%,1) 0, transparent 50%), 
                radial-gradient(at 100% 0%, hsla(210,100%,70%,1) 0, transparent 50%), 
                radial-gradient(at 100% 100%, hsla(160,100%,70%,1) 0, transparent 50%), 
                radial-gradient(at 0% 100%, hsla(192,100%,70%,1) 0, transparent 50%);
            background-size: 200% 200%;
            animation: auraBG 15s ease infinite;
        }
        @keyframes auraBG { 0% {background-position:0% 50%} 50% {background-position:100% 50%} 100% {background-position:0% 50%} }

        /* --- 1. INTRO & SETUP --- */
        #intro-screen {
            position: fixed; inset: 0; z-index: 50000;
            background: white;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            transition: opacity 0.8s ease;
        }
        #intro-screen.hidden { opacity: 0; pointer-events: none; }

        .intro-content { text-align: center; padding: 40px; opacity: 0; animation: fadeUp 1s ease forwards 0.5s; }
        .logo-intro { 
            font-size: 2.5rem; font-weight: 700; margin-bottom: 10px;
            background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .quote-box { font-size: 1.2rem; color: var(--text-muted); font-style: italic; max-width: 600px; margin-bottom: 40px; line-height: 1.6; }
        .intro-btn {
            padding: 16px 40px; background: var(--primary-gradient); color: white; border: none;
            border-radius: 50px; font-weight: 600; font-size: 1rem; cursor: pointer;
            box-shadow: 0 10px 20px rgba(0, 114, 255, 0.3); transition: transform 0.2s;
        }
        .intro-btn:hover { transform: scale(1.05); }

        @keyframes fadeUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }

        /* Setup Modal */
        #setup-screen {
            position: fixed; inset: 0; background: rgba(255,255,255,0.9); backdrop-filter: blur(10px);
            z-index: 40000; display: none; align-items: center; justify-content: center;
        }
        #setup-screen.visible { display: flex; }
        
        .setup-card {
            background: white; padding: 50px; border-radius: 40px; width: 90%; max-width: 450px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.1); text-align: center;
        }
        .avatar-wrap {
            width: 120px; height: 120px; margin: 0 auto 30px; position: relative; cursor: pointer;
        }
        .setup-av { width: 100%; height: 100%; border-radius: 50%; object-fit: cover; box-shadow: var(--shadow-soft); border: 4px solid white; }
        .cam-badge {
            position: absolute; bottom: 0; right: 0; width: 40px; height: 40px; background: var(--primary-gradient);
            color: white; border-radius: 50%; display: flex; align-items: center; justify-content: center;
            border: 4px solid white; font-size: 1.2rem;
        }
        .setup-inp {
            width: 100%; padding: 18px; border-radius: 20px; border: 2px solid #f0f0f0;
            font-size: 1.1rem; text-align: center; outline: none; margin-bottom: 25px;
            font-family: 'Poppins', sans-serif; transition: 0.3s;
        }
        .setup-inp:focus { border-color: #00c6ff; background: #fdfdfd; }


        /* --- 2. APP LAYOUT --- */
        .app-shell { display: flex; height: 100%; width: 100%; opacity: 0; transition: opacity 1s; }
        .app-shell.visible { opacity: 1; }

        /* Sidebar */
        .sidebar {
            width: 280px; background: rgba(255,255,255,0.85); backdrop-filter: blur(20px);
            padding: 40px 30px; display: flex; flex-direction: column; gap: 15px;
            border-top-right-radius: 40px; border-bottom-right-radius: 40px;
            box-shadow: 10px 0 40px rgba(0,0,0,0.02); z-index: 10;
        }
        .logo-area { font-size: 1.8rem; font-weight: 800; color: var(--text-main); margin-bottom: 40px; }
        .logo-area span { color: #0072ff; }

        .nav-btn {
            background: transparent; border: none; padding: 16px 20px; border-radius: 20px;
            color: var(--text-muted); font-size: 1rem; font-weight: 500; cursor: pointer;
            text-align: left; display: flex; align-items: center; gap: 15px; transition: 0.3s;
        }
        .nav-btn:hover { background: rgba(0, 198, 255, 0.1); color: #0072ff; }
        .nav-btn.active { 
            background: var(--primary-gradient); color: white; 
            box-shadow: 0 10px 20px rgba(0, 114, 255, 0.25); font-weight: 600;
        }
        .nav-btn i { font-size: 1.4rem; }

        .profile-mini {
            margin-top: auto; display: flex; align-items: center; gap: 15px;
            padding: 15px; background: white; border-radius: 25px; box-shadow: 0 5px 20px rgba(0,0,0,0.05);
        }
        .profile-mini img { width: 45px; height: 45px; border-radius: 50%; object-fit: cover; }

        /* Main View */
        .main-view { flex: 1; overflow-y: auto; padding: 50px 60px; position: relative; }
        
        .section { display: none; animation: slideUp 0.6s ease-out; }
        .section.active { display: block; }
        @keyframes slideUp { from {opacity:0; transform:translateY(30px);} to {opacity:1; transform:translateY(0);} }

        .header { margin-bottom: 40px; }
        .greeting { font-size: 3rem; font-weight: 700; margin: 0; color: var(--text-main); }
        .subtitle { color: var(--text-muted); font-size: 1.1rem; margin-top: 5px; }

        /* Grid */
        .grid-layout { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 30px; }
        
        /* Glass Cards (Aura Style) */
        .aura-card {
            background: var(--glass-surface); border: 1px solid var(--glass-border);
            border-radius: var(--radius-lg); padding: 35px;
            box-shadow: var(--shadow-soft); backdrop-filter: blur(25px);
            transition: transform 0.3s ease; position: relative; overflow: visible;
        }
        .aura-card:hover { transform: translateY(-5px); }
        .card-head { display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px; }
        .card-title { font-weight: 600; font-size: 1.1rem; color: var(--text-main); }

        /* --- TIMER --- */
        .timer-display { 
            font-size: 5rem; font-weight: 700; text-align: center; margin: 20px 0;
            background: var(--primary-gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .chip { 
            background: white; padding: 8px 20px; border-radius: 30px; font-size: 0.9rem; font-weight: 600;
            color: var(--text-muted); cursor: pointer; transition: 0.3s; border: 1px solid transparent;
        }
        .chip.active { background: #e0f7fa; color: #0072ff; border-color: #00c6ff; }
        .time-controls { display: flex; gap: 10px; justify-content: center; margin-bottom: 30px; }
        
        .main-btn {
            width: 100%; padding: 18px; border-radius: 25px; border: none;
            background: var(--primary-gradient); color: white; font-weight: 600; font-size: 1.1rem;
            cursor: pointer; box-shadow: 0 10px 25px rgba(0, 114, 255, 0.3); transition: 0.2s;
        }
        .main-btn:hover { transform: scale(1.02); box-shadow: 0 15px 35px rgba(0, 114, 255, 0.4); }

        .breath-btn {
            margin-top: 15px; width: 100%; padding: 14px; background: white;
            color: #0072ff; font-weight: 600; border-radius: 25px; cursor: pointer; border: none;
            box-shadow: 0 5px 15px rgba(0,0,0,0.05); display: flex; align-items: center; justify-content: center; gap: 10px; transition: 0.2s;
        }
        .breath-btn:hover { background: #f0f9ff; }

        /* --- TASKS (UPDATED DESIGN) --- */
        .task-input-area { display: flex; gap: 15px; margin-bottom: 30px; }
        .task-inp {
            flex: 1; padding: 18px 25px; border-radius: 25px; border: none; background: white;
            font-size: 1rem; outline: none; box-shadow: inset 0 2px 5px rgba(0,0,0,0.02); transition: 0.3s;
        }
        .task-inp:focus { box-shadow: inset 0 2px 5px rgba(0,0,0,0.05), 0 0 0 3px rgba(0, 198, 255, 0.2); }
        .add-btn { background: var(--primary-gradient); color: white; border: none; padding: 0 35px; border-radius: 25px; font-weight: 600; cursor: pointer; }

        .task-item {
            display: flex; align-items: center; justify-content: space-between;
            padding: 20px; background: white; border-radius: 25px; margin-bottom: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.03); transition: 0.2s;
        }
        .task-item:hover { transform: translateX(5px); box-shadow: 0 8px 25px rgba(0,0,0,0.06); }
        .task-txt { font-weight: 500; font-size: 1.05rem; color: var(--text-main); }
        
        .task-actions { display: flex; align-items: center; gap: 10px; }
        .btn-icon { width: 40px; height: 40px; border-radius: 50%; display: flex; align-items: center; justify-content: center; border: none; cursor: pointer; transition: 0.2s; font-size: 1.2rem; }
        .btn-del { background: #fee2e2; color: var(--danger); }
        .btn-del:hover { background: var(--danger); color: white; }
        .btn-done { background: #dcfce7; color: var(--success); width: auto; padding: 0 20px; border-radius: 20px; font-size: 0.9rem; font-weight: 600; }
        .btn-done:hover { background: var(--success); color: white; }

        /* --- SCHEDULE --- */
        .sch-grid { display: grid; grid-template-columns: 70px repeat(5, 1fr); gap: 2px; background: #e0f2f1; border-radius: 25px; overflow: hidden; min-width: 650px; }
        .sch-cell { background: white; padding: 15px; min-height: 80px; display: flex; align-items: center; justify-content: center; font-size: 0.9rem; cursor: pointer; transition: 0.2s; }
        .sch-cell:hover { background: #f0fdff; }
        .sch-head { background: #e0f7fa; padding: 15px; font-weight: 600; color: #0072ff; text-align: center; }
        .sch-active { background: #00c6ff; color: white; font-weight: 700; box-shadow: 0 0 20px rgba(0, 198, 255, 0.4); z-index: 2; }

        /* --- OVERLAYS --- */
        #breath-overlay, #success-overlay {
            position: fixed; inset: 0; background: rgba(255,255,255,0.9); backdrop-filter: blur(20px);
            z-index: 60000; display: none; flex-direction: column; align-items: center; justify-content: center;
            opacity: 0; transition: opacity 0.5s;
        }
        #breath-overlay.active, #success-overlay.active { display: flex; opacity: 1; }
        
        .breath-orb { width: 200px; height: 200px; background: var(--primary-gradient); border-radius: 50%; box-shadow: 0 0 60px rgba(0, 198, 255, 0.5); display: flex; align-items: center; justify-content: center; color: white; font-size: 1.5rem; font-weight: 700; letter-spacing: 2px; text-align: center; }
        @keyframes breathe { 
            0%, 100% { transform: scale(1); opacity: 0.8; } 
            50% { transform: scale(1.5); opacity: 1; } 
        }
        .breathing { animation: breathe 8s ease-in-out infinite; }

        .success-card-modal { background: white; padding: 50px; border-radius: 40px; text-align: center; box-shadow: 0 30px 80px rgba(0,0,0,0.1); transform: scale(0.8); transition: transform 0.3s; }
        #success-overlay.active .success-card-modal { transform: scale(1); }

        /* Mobile */
        .mobile-nav { display: none; }
        @media (max-width: 768px) { 
            .sidebar { display: none; } 
            .mobile-nav { display: flex; position: fixed; bottom: 0; width: 100%; background: white; padding: 15px; justify-content: space-around; border-top-left-radius: 30px; border-top-right-radius: 30px; box-shadow: 0 -10px 40px rgba(0,0,0,0.05); z-index: 100; }
            .main-view { padding: 30px 20px 100px 20px; } 
            .greeting { font-size: 2.2rem; }
        }
        .mob-btn { background: none; border: none; color: #ccc; font-size: 1.5rem; transition: 0.3s; }
        .mob-btn.active { color: #0072ff; transform: translateY(-5px); }

    </style>
</head>
<body>

    <input type="file" id="avatarUpload" style="display:none">
    <input type="file" id="setupAvatarUpload" style="display:none">

    <div id="intro-screen">
        <div class="intro-content">
            <div class="logo-intro">mehdi.co</div>
            <div class="quote-box" id="quoteBox">"Laster sitat..."</div>
            <button class="intro-btn" onclick="goToSetup()">Start Reisen</button>
        </div>
    </div>

    <div id="setup-screen">
        <div class="setup-card">
            <h2 style="font-size:2rem; font-weight:700; margin-bottom:30px; color:var(--text-main);">Hei der! üëã</h2>
            <div class="avatar-wrap" onclick="document.getElementById('setupAvatarUpload').click()">
                <img id="setupAvPreview" class="setup-av" src="https://api.dicebear.com/7.x/notionists/svg?seed=student">
                <div class="cam-badge"><i class="ph ph-camera"></i></div>
            </div>
            <input type="text" id="setupName" class="setup-inp" placeholder="Ditt Navn">
            <button class="intro-btn" onclick="enterApp()">√Öpne Appen</button>
        </div>
    </div>

    <div class="app-shell" id="app-shell">
        <aside class="sidebar">
            <div class="logo-area">mehdi<span>.co</span></div>
            <button class="nav-btn active" onclick="nav('dashboard')"><i class="ph ph-squares-four"></i> Oversikt</button>
            <button class="nav-btn" onclick="nav('schedule')"><i class="ph ph-calendar"></i> Timeplan</button>
            <button class="nav-btn" onclick="nav('tools')"><i class="ph ph-calculator"></i> Verkt√∏y</button>
            <button class="nav-btn" onclick="nav('tasks')"><i class="ph ph-check-square"></i> Oppgaver</button>
            <button class="nav-btn" onclick="nav('settings')"><i class="ph ph-gear"></i> Innstillinger</button>
            <div class="profile-mini">
                <img id="miniAv" src="">
                <div><div id="miniName" style="font-weight:600;">Navn</div><div style="font-size:0.8rem; color:#0072ff;">Aura User</div></div>
            </div>
        </aside>

        <main class="main-view">
            
            <section id="dashboard" class="section active">
                <div class="header">
                    <h1 class="greeting" id="greet">Hei</h1>
                    <p class="subtitle" id="dateSub">Klar for en produktiv dag?</p>
                </div>

                <div class="grid-layout">
                    <div class="aura-card" style="text-align:center;">
                        <div class="card-head"><span class="card-title">Fokus</span><i class="ph ph-hourglass-high" style="color:#00c6ff; font-size:1.5rem;"></i></div>
                        <div class="timer-display" id="timer">25:00</div>
                        <div class="time-controls">
                            <div class="chip" onclick="setDuration(10)">10m</div>
                            <div class="chip active" onclick="setDuration(25)">25m</div>
                            <div class="chip" onclick="setDuration(45)">45m</div>
                        </div>
                        <button class="main-btn" id="timerBtn" onclick="toggleTimer()">Start √òkt</button>
                        <button class="breath-btn" onclick="startBreath()"><i class="ph ph-wind"></i> Pustepause</button>
                    </div>

                    <div class="aura-card">
                        <div class="card-head"><span class="card-title">Aktivitet</span></div>
                        <div style="height:200px;"><canvas id="chart"></canvas></div>
                    </div>
                </div>
            </section>

            <section id="tasks" class="section">
                <div class="header"><h1 class="greeting">Oppgaver</h1></div>
                <div class="aura-card" style="max-width:800px;">
                    <div class="task-input-area">
                        <input type="text" class="task-inp" id="taskInput" placeholder="Skriv ny oppgave...">
                        <button class="add-btn" onclick="addTask()">Legg til</button>
                    </div>
                    <div id="taskList"></div>
                </div>
            </section>

            <section id="schedule" class="section">
                <div class="header"><h1 class="greeting">Ukeplan</h1></div>
                <div class="aura-card">
                    <div style="overflow-x:auto; padding-bottom:10px;">
                        <div class="sch-grid" id="schGrid"></div>
                    </div>
                </div>
            </section>

            <section id="tools" class="section">
                <div class="header"><h1 class="greeting">Verkt√∏y</h1></div>
                <div class="grid-layout">
                    <div class="aura-card" style="max-width:350px;">
                        <input type="text" id="calcDisp" style="width:100%; font-size:2.5rem; text-align:right; border:none; outline:none; margin-bottom:20px; background:transparent; font-weight:700; color:#0072ff;" readonly value="0">
                        <div style="display:grid; grid-template-columns:repeat(4,1fr); gap:12px;">
                            <button class="chip" onclick="add('7')">7</button><button class="chip" onclick="add('8')">8</button><button class="chip" onclick="add('9')">9</button><button class="chip" style="color:#0072ff;" onclick="add('/')">√∑</button>
                            <button class="chip" onclick="add('4')">4</button><button class="chip" onclick="add('5')">5</button><button class="chip" onclick="add('6')">6</button><button class="chip" style="color:#0072ff;" onclick="add('*')">√ó</button>
                            <button class="chip" onclick="add('1')">1</button><button class="chip" onclick="add('2')">2</button><button class="chip" onclick="add('3')">3</button><button class="chip" style="color:#0072ff;" onclick="add('-')">-</button>
                            <button class="chip" style="color:red;" onclick="cls()">C</button><button class="chip" onclick="add('0')">0</button><button class="chip" onclick="add('.')">.</button><button class="chip" style="background:var(--primary-gradient); color:white;" onclick="solve()">=</button>
                        </div>
                    </div>
                    <div class="aura-card">
                        <div class="card-head"><span class="card-title">Notater</span></div>
                        <textarea id="notes" style="width:100%; height:300px; border:none; outline:none; resize:none; font-size:1rem; font-family:'Poppins',sans-serif; color:var(--text-main);" placeholder="Skriv her..."></textarea>
                    </div>
                </div>
            </section>

            <section id="settings" class="section">
                <div class="header"><h1 class="greeting">Innstilinger</h1></div>
                <div class="aura-card" style="text-align:center; padding:50px;">
                    <div class="avatar-wrap" onclick="document.getElementById('avatarUpload').click()">
                        <img id="bigAv" class="setup-av" src="">
                        <div class="cam-badge"><i class="ph ph-camera"></i></div>
                    </div>
                    <h2 id="bigName" style="margin-bottom:10px;">Navn</h2>
                    <button class="chip" onclick="editName()">Endre Navn</button>
                </div>
            </section>

        </main>

        <nav class="mobile-nav">
            <button class="mob-btn active" onclick="nav('dashboard')"><i class="ph ph-squares-four"></i></button>
            <button class="mob-btn" onclick="nav('schedule')"><i class="ph ph-calendar"></i></button>
            <button class="mob-btn" onclick="nav('tools')"><i class="ph ph-calculator"></i></button>
            <button class="mob-btn" onclick="nav('tasks')"><i class="ph ph-check-square"></i></button>
            <button class="mob-btn" onclick="nav('settings')"><i class="ph ph-user"></i></button>
        </nav>
    </div>

    <div id="breath-overlay">
        <div class="breath-orb breathing" id="bOrb">PUST INN</div>
        <button class="chip" onclick="stopBreath()" style="margin-top:50px; background:white; color:black;">Avslutt</button>
    </div>

    <div id="success-overlay">
        <div class="success-card-modal">
            <i class="ph ph-check-circle" style="font-size:6rem; color:#10b981; margin-bottom:20px;"></i>
            <h2 style="font-size:2rem; font-weight:700;">Fantastisk!</h2>
            <p style="color:#64748b;">Du fullf√∏rte en oppgave.</p>
            <div style="margin-top:20px; font-weight:700; color:#0072ff;">+25 XP</div>
        </div>
    </div>

<script>
    // --- 1. INTRO & LOGIC ---
    const quotes = [
        { t: "Det eneste umulige er det du ikke pr√∏ver p√•.", a: "Ukjent" },
        { t: "Fremtiden tilh√∏rer de som tror p√• dr√∏mmene sine.", a: "Eleanor Roosevelt" }
    ];

    window.onload = function() {
        const q = quotes[Math.floor(Math.random() * quotes.length)];
        document.getElementById('quoteBox').innerHTML = `"${q.t}"<br><span style="font-size:0.9rem; margin-top:10px; display:block;">- ${q.a}</span>`;
        
        if(localStorage.getItem('AuraOS')) {
            state = JSON.parse(localStorage.getItem('AuraOS'));
            if(state.name !== "Student") {
                document.getElementById('setupName').value = state.name;
                document.getElementById('setupAvPreview').src = state.avatar;
            }
        }
        updateUI();
    };

    function goToSetup() { document.getElementById('intro-screen').classList.add('hidden'); document.getElementById('setup-screen').classList.add('visible'); }
    function enterApp() {
        const n = document.getElementById('setupName').value;
        if(n) state.name = n;
        save(); updateUI();
        document.getElementById('setup-screen').classList.remove('visible');
        document.getElementById('app-shell').classList.add('visible');
    }

    let state = { name: "Student", avatar: "https://api.dicebear.com/7.x/notionists/svg?seed=student", xp: 0, tasks: [], notes: "", schedule: {} };
    function save() { localStorage.setItem('AuraOS', JSON.stringify(state)); }

    function updateUI() {
        const hr = new Date().getHours();
        let gt = hr < 12 ? "God morgen" : hr < 18 ? "God ettermiddag" : "God kveld";
        document.getElementById('greet').innerText = `${gt}, ${state.name}`;
        document.getElementById('miniName').innerText = state.name;
        document.getElementById('bigName').innerText = state.name;
        document.getElementById('miniAv').src = state.avatar;
        document.getElementById('bigAv').src = state.avatar;
        document.getElementById('notes').value = state.notes;
        const dateOpt = { weekday: 'long', month: 'long', day: 'numeric' };
        document.getElementById('dateSub').innerText = "Det er " + new Date().toLocaleDateString('no-NO', dateOpt);
        renderTasks(); renderSchedule();
    }

    function nav(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        document.querySelectorAll('.nav-btn, .mob-btn').forEach(b => b.classList.remove('active'));
        if(event) event.currentTarget.classList.add('active');
    }

    // --- TASKS ---
    function addTask() {
        const v = document.getElementById('taskInput').value;
        if(!v) return;
        state.tasks.unshift({id:Date.now(), t:v}); save(); renderTasks();
        document.getElementById('taskInput').value="";
    }
    function removeTask(id) { state.tasks = state.tasks.filter(t=>t.id!==id); save(); renderTasks(); }
    function completeTask(id) {
        state.xp += 25; state.tasks = state.tasks.filter(t=>t.id!==id); save(); renderTasks();
        const ov = document.getElementById('success-overlay');
        ov.classList.add('active');
        setTimeout(() => ov.classList.remove('active'), 2000);
    }
    function renderTasks() {
        const l = document.getElementById('taskList'); l.innerHTML="";
        state.tasks.forEach(t=>{
            l.innerHTML += `
            <div class="task-item">
                <span class="task-txt">${t.t}</span>
                <div class="task-actions">
                    <button class="btn-icon btn-del" onclick="removeTask(${t.id})"><i class="ph ph-x"></i></button>
                    <button class="btn-done" onclick="completeTask(${t.id})"><i class="ph ph-check"></i> Ferdig</button>
                </div>
            </div>`;
        });
    }

    // --- SCHEDULE ---
    function renderSchedule() {
        const g = document.getElementById('schGrid');
        g.innerHTML = '<div class="sch-head">Tid</div><div class="sch-head">Man</div><div class="sch-head">Tir</div><div class="sch-head">Ons</div><div class="sch-head">Tor</div><div class="sch-head">Fre</div>';
        const times = ["08:00","09:00","10:00","11:00","12:00","13:00","14:00"];
        const days = ["Mon","Tue","Wed","Thu","Fri"];
        const now = new Date(); const dIdx = now.getDay(); const h = now.getHours();
        times.forEach(t => {
            g.innerHTML += `<div class="sch-cell" style="color:#888;">${t}</div>`;
            days.forEach((d, i) => {
                const k = `${d}-${t}`; const v = state.schedule[k] || "";
                let ac = ""; if(i+1 === dIdx && t.startsWith(h.toString().padStart(2,'0'))) ac = "sch-active";
                g.innerHTML += `<div class="sch-cell ${ac}" onclick="editSch('${k}')">${v}</div>`;
            });
        });
    }
    function editSch(k) { const v = prompt("Fag:"); if(v!==null) { state.schedule[k]=v; save(); renderSchedule(); }}

    // --- TOOLS ---
    let ex = ""; function add(v){ex+=v; document.getElementById('calcDisp').value=ex;} function cls(){ex=""; document.getElementById('calcDisp').value="0";} function solve(){try{document.getElementById('calcDisp').value=eval(ex); ex=eval(ex).toString();}catch{document.getElementById('calcDisp').value="Error"; ex="";}}
    document.getElementById('notes').addEventListener('input', (e)=>{state.notes=e.target.value; save();});
    
    // Settings
    function editName() { const n = prompt("Nytt navn:"); if(n) { state.name=n; save(); updateUI(); } }
    document.getElementById('setupAvatarUpload').addEventListener('change', hAv); document.getElementById('avatarUpload').addEventListener('change', hAv);
    function hAv(e) { if(e.target.files[0]) { const r = new FileReader(); r.onload=(evt)=>{state.avatar=evt.target.result; if(document.getElementById('setupAvPreview'))document.getElementById('setupAvPreview').src=state.avatar; save(); updateUI();}; r.readAsDataURL(e.target.files[0]); }}

    // Timer & Breath
    let tTime=1500; let tInt;
    function setDuration(m){tTime=m*60; document.getElementById('timer').innerText=`${m}:00`;}
    function toggleTimer() {
        const b = document.getElementById('timerBtn');
        if(tInt) { clearInterval(tInt); tInt=null; b.innerText="Start √òkt"; }
        else {
            b.innerText = "Pause";
            tInt = setInterval(() => {
                tTime--; let m=Math.floor(tTime/60); let s=tTime%60;
                document.getElementById('timer').innerText = `${m}:${s<10?'0':''}${s}`;
                if(tTime<=0) clearInterval(tInt);
            }, 1000);
        }
    }
    
    let bInt;
    function startBreath() {
        document.getElementById('breath-overlay').classList.add('active');
        const b = document.getElementById('bOrb');
        let ph = 0;
        function cycle() {
            if(ph===0) { b.innerText="PUST INN"; ph=1; }
            else { b.innerText="PUST UT"; ph=0; }
        }
        cycle();
        bInt = setInterval(cycle, 4000);
    }
    function stopBreath() {
        document.getElementById('breath-overlay').classList.remove('active');
        clearInterval(bInt);
    }

    new Chart(document.getElementById('chart'), { type: 'line', data: { labels: ['M','T','O','T','F'], datasets: [{ label:'Fokus', data:[60,80,40,90,75], borderColor:'#00c6ff', tension:0.4, fill:true, backgroundColor:'rgba(0, 198, 255, 0.1)' }] }, options: { responsive:true, maintainAspectRatio:false, plugins:{legend:{display:false}}, scales:{x:{display:false, grid:{display:false}}, y:{display:false, grid:{display:false}}} } });
</script>
</body>
</html>
